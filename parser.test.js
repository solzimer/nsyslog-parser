const parser = require("./parser.js");

const currentYear = new Date().getFullYear();

/**
 * Parses the date string and replaces the year with the current calendar year, e.g. for "2019-10-11T21:14:15.000Z"
 * a date object 2021-10-11T21:14:15.000Z would be returned if it is the year 2021
 * @param {string} date string
 * @returns the date object representing the string but with the current year
 */
function dateAsCurrentYear(date) {
  return new Date(new Date(date).setFullYear(currentYear));
}

test.each([
  {
    originalMessage: "23",
    chain: [],
    host: "",
    prival: null,
    pri: "",
    ts: expect.anything(),
    type: "UNKNOWN",
    version: 23,
  },
  {
    originalMessage:
      "<34>Oct 11 22:14:15 mymachine su: 'su root' failed for lonvick on /dev/pts/8",
    pri: "<34>",
    prival: 34,
    facilityval: 4,
    levelval: 2,
    facility: "auth",
    level: "crit",
    type: "BSD",
    ts: dateAsCurrentYear("2019-10-11T21:14:15.000Z"),
    host: "mymachine",
    appName: "su",
    message: "'su root' failed for lonvick on /dev/pts/8",
    chain: [],
    fields: [],
    header: "<34>Oct 11 22:14:15 mymachine su: ",
  },
  {
    originalMessage:
      "<34>OCT 11 22:14:15 mymachine su: 'su root' failed for lonvick on /dev/pts/8",
    pri: "<34>",
    prival: 34,
    facilityval: 4,
    levelval: 2,
    facility: "auth",
    level: "crit",
    type: "BSD",
    ts: dateAsCurrentYear("2019-10-11T21:14:15.000Z"),
    host: "mymachine",
    appName: "su",
    message: "'su root' failed for lonvick on /dev/pts/8",
    chain: [],
    fields: [],
    header: "<34>OCT 11 22:14:15 mymachine su: ",
  },
  {
    originalMessage:
      "<34>Oct 11 22:14:15.123 UTC mymachine su: 'su root' failed for lonvick on /dev/pts/8",
    pri: "<34>",
    prival: 34,
    facilityval: 4,
    levelval: 2,
    facility: "auth",
    level: "crit",
    type: "BSD",
    ts: dateAsCurrentYear("2019-10-11T22:14:15.123Z"),
    host: "mymachine",
    appName: "su",
    message: "'su root' failed for lonvick on /dev/pts/8",
    chain: [],
    fields: [],
    header: "<34>Oct 11 22:14:15.123 UTC mymachine su: ",
  },
  {
    originalMessage:
      "<34>Oct 11 22:14:15.123 mymachine su: 'su root' failed for lonvick on /dev/pts/8",
    pri: "<34>",
    prival: 34,
    facilityval: 4,
    levelval: 2,
    facility: "auth",
    level: "crit",
    type: "BSD",
    ts: dateAsCurrentYear("2019-10-11T21:14:15.123Z"),
    host: "mymachine",
    appName: "su",
    message: "'su root' failed for lonvick on /dev/pts/8",
    chain: [],
    fields: [],
    header: "<34>Oct 11 22:14:15.123 mymachine su: ",
  },
  {
    originalMessage:
      "<34>Oct 11 22:14:15 UTC mymachine su: 'su root' failed for lonvick on /dev/pts/8",
    pri: "<34>",
    prival: 34,
    facilityval: 4,
    levelval: 2,
    facility: "auth",
    level: "crit",
    type: "BSD",
    ts: dateAsCurrentYear("2019-10-11T22:14:15.000Z"),
    host: "mymachine",
    appName: "su",
    message: "'su root' failed for lonvick on /dev/pts/8",
    chain: [],
    fields: [],
    header: "<34>Oct 11 22:14:15 UTC mymachine su: ",
  },
  {
    originalMessage:
      "<34>Oct 11 2019 22:14:15 mymachine su: 'su root' failed for lonvick on /dev/pts/8",
    pri: "<34>",
    prival: 34,
    facilityval: 4,
    levelval: 2,
    facility: "auth",
    level: "crit",
    type: "BSD",
    ts: new Date("2019-10-11T21:14:15.000Z"),
    host: "mymachine",
    appName: "su",
    message: "'su root' failed for lonvick on /dev/pts/8",
    chain: [],
    fields: [],
    header: "<34>Oct 11 2019 22:14:15 mymachine su: ",
  },
  {
    originalMessage:
      "<34>Oct 11 2019 22:14:15.123 UTC mymachine su: 'su root' failed for lonvick on /dev/pts/8",
    pri: "<34>",
    prival: 34,
    facilityval: 4,
    levelval: 2,
    facility: "auth",
    level: "crit",
    type: "BSD",
    ts: new Date("2019-10-11T22:14:15.123Z"),
    host: "mymachine",
    appName: "su",
    message: "'su root' failed for lonvick on /dev/pts/8",
    chain: [],
    fields: [],
    header: "<34>Oct 11 2019 22:14:15.123 UTC mymachine su: ",
  },
  {
    originalMessage:
      "<34>Oct 11 2019 22:14:15.123 mymachine su: 'su root' failed for lonvick on /dev/pts/8",
    pri: "<34>",
    prival: 34,
    facilityval: 4,
    levelval: 2,
    facility: "auth",
    level: "crit",
    type: "BSD",
    ts: new Date("2019-10-11T21:14:15.123Z"),
    host: "mymachine",
    appName: "su",
    message: "'su root' failed for lonvick on /dev/pts/8",
    chain: [],
    fields: [],
    header: "<34>Oct 11 2019 22:14:15.123 mymachine su: ",
  },
  {
    originalMessage:
      "<34>Oct 11 2019 22:14:15.123 UTC mymachine su: 'su root' failed for lonvick on /dev/pts/8",
    pri: "<34>",
    prival: 34,
    facilityval: 4,
    levelval: 2,
    facility: "auth",
    level: "crit",
    type: "BSD",
    ts: new Date("2019-10-11T22:14:15.123Z"),
    host: "mymachine",
    appName: "su",
    message: "'su root' failed for lonvick on /dev/pts/8",
    chain: [],
    fields: [],
    header: "<34>Oct 11 2019 22:14:15.123 UTC mymachine su: ",
  },
  {
    originalMessage:
      "<34>1 2003-10-11T22:14:15.003Z mymachine.example.com su - ID47 - BOM'su root' failed for lonvick on /dev/pts/8",
    pri: "<34>",
    prival: 34,
    facilityval: 4,
    levelval: 2,
    facility: "auth",
    level: "crit",
    version: 1,
    type: "RFC5424",
    ts: new Date("2003-10-11T22:14:15.003Z"),
    host: "mymachine.example.com",
    appName: "su",
    pid: "-",
    messageid: "ID47",
    structuredData: [],
    message: "BOM'su root' failed for lonvick on /dev/pts/8",
    chain: [],
    fields: [],
    header: "<34>1 2003-10-11T22:14:15.003Z mymachine.example.com su - ID47 - ",
  },
  {
    originalMessage:
      '<189>May 3 16:02:05 192.168.26.254 date=2017-05-03 time=16:02:05 devname=FG600B3909601440 devid=FG600B3909601440 logid=0000000013 type=traffic subtype=forward level=notice vd=VDOM-SNOC srcip=192.168.110.60 srcport=57668 srcintf="port7" dstip=192.168.15.100 dstport=443 dstintf="Gestion" sessionid=128467614 proto=6 action=close policyid=33 dstcountry="Reserved" srccountry="Reserved" trandisp=snat transip=192.168.15.254 transport=57668 service="HTTPS" duration=35 sentbyte=132 rcvdbyte=172 sentpkt=3 rcvdpkt=4 appcat="unscanned"',
    pri: "<189>",
    prival: 189,
    facilityval: 23,
    levelval: 5,
    facility: "local7",
    level: "notice",
    type: "BSD",
    ts: dateAsCurrentYear("2019-05-03T15:02:05.000Z"),
    host: "192.168.26.254",
    message:
      'date=2017-05-03 time=16:02:05 devname=FG600B3909601440 devid=FG600B3909601440 logid=0000000013 type=traffic subtype=forward level=notice vd=VDOM-SNOC srcip=192.168.110.60 srcport=57668 srcintf="port7" dstip=192.168.15.100 dstport=443 dstintf="Gestion" sessionid=128467614 proto=6 action=close policyid=33 dstcountry="Reserved" srccountry="Reserved" trandisp=snat transip=192.168.15.254 transport=57668 service="HTTPS" duration=35 sentbyte=132 rcvdbyte=172 sentpkt=3 rcvdpkt=4 appcat="unscanned"',
    chain: [],
    fields: [],
    header: "<189>May 3 16:02:05 192.168.26.254 ",
  },
  {
    originalMessage:
      '192.168.26.254 time=16:31:28 devname=FG600B3909601440 devid=FG600B3909601440 logid=0000000013 type=traffic subtype=forward level=notice vd=VDOM-SNOC srcip=192.168.22.68 srcport=51448 srcintf="port3" dstip=216.58.210.174 dstport=443 dstintf="port7" sessionid=128625552 proto=6 action=close policyid=39 dstcountry="United States" srccountry="Reserved" trandisp=noop service="HTTPS" duration=241 sentbyte=132 rcvdbyte=92 sentpkt=3 rcvdpkt=2 appcat="unscanned"',
    pri: "",
    prival: null,
    type: "UNKNOWN",
    ts: expect.any(Date),
    host: "192.168.26.254",
    message:
      'time=16:31:28 devname=FG600B3909601440 devid=FG600B3909601440 logid=0000000013 type=traffic subtype=forward level=notice vd=VDOM-SNOC srcip=192.168.22.68 srcport=51448 srcintf="port3" dstip=216.58.210.174 dstport=443 dstintf="port7" sessionid=128625552 proto=6 action=close policyid=39 dstcountry="United States" srccountry="Reserved" trandisp=noop service="HTTPS" duration=241 sentbyte=132 rcvdbyte=92 sentpkt=3 rcvdpkt=2 appcat="unscanned"',
    chain: [],
    header: "192.168.26.254 ",
  },
  {
    originalMessage:
      '<189>time=16:31:28 devname=FG600B3909601440 devid=FG600B3909601440 logid=0000000013 type=traffic subtype=forward level=notice vd=VDOM-SNOC srcip=192.168.22.68 srcport=51448 srcintf="port3" dstip=216.58.210.174 dstport=443 dstintf="port7" sessionid=128625552 proto=6 action=close policyid=39 dstcountry="United States" srccountry="Reserved" trandisp=noop service="HTTPS" duration=241 sentbyte=132 rcvdbyte=92 sentpkt=3 rcvdpkt=2 appcat="unscanned"',
    pri: "<189>",
    prival: 189,
    facilityval: 23,
    levelval: 5,
    facility: "local7",
    level: "notice",
    type: "UNKNOWN",
    ts: expect.any(Date),
    message:
      'time=16:31:28 devname=FG600B3909601440 devid=FG600B3909601440 logid=0000000013 type=traffic subtype=forward level=notice vd=VDOM-SNOC srcip=192.168.22.68 srcport=51448 srcintf="port3" dstip=216.58.210.174 dstport=443 dstintf="port7" sessionid=128625552 proto=6 action=close policyid=39 dstcountry="United States" srccountry="Reserved" trandisp=noop service="HTTPS" duration=241 sentbyte=132 rcvdbyte=92 sentpkt=3 rcvdpkt=2 appcat="unscanned"',
    chain: [],
    host: "",
    header: "<189>",
  },
  {
    originalMessage:
      '<189>192.168.26.254 time=16:31:28 devname=FG600B3909601440 devid=FG600B3909601440 logid=0000000013 type=traffic subtype=forward level=notice vd=VDOM-SNOC srcip=192.168.22.68 srcport=51448 srcintf="port3" dstip=216.58.210.174 dstport=443 dstintf="port7" sessionid=128625552 proto=6 action=close policyid=39 dstcountry="United States" srccountry="Reserved" trandisp=noop service="HTTPS" duration=241 sentbyte=132 rcvdbyte=92 sentpkt=3 rcvdpkt=2 appcat="unscanned"',
    pri: "<189>",
    prival: 189,
    facilityval: 23,
    levelval: 5,
    facility: "local7",
    level: "notice",
    type: "UNKNOWN",
    ts: expect.any(Date),
    host: "192.168.26.254",
    message:
      'time=16:31:28 devname=FG600B3909601440 devid=FG600B3909601440 logid=0000000013 type=traffic subtype=forward level=notice vd=VDOM-SNOC srcip=192.168.22.68 srcport=51448 srcintf="port3" dstip=216.58.210.174 dstport=443 dstintf="port7" sessionid=128625552 proto=6 action=close policyid=39 dstcountry="United States" srccountry="Reserved" trandisp=noop service="HTTPS" duration=241 sentbyte=132 rcvdbyte=92 sentpkt=3 rcvdpkt=2 appcat="unscanned"',
    chain: [],
    header: "<189>192.168.26.254 ",
  },
  {
    originalMessage:
      '<189>192.168.26.254 myApp time=16:31:28 devname=FG600B3909601440 devid=FG600B3909601440 logid=0000000013 type=traffic subtype=forward level=notice vd=VDOM-SNOC srcip=192.168.22.68 srcport=51448 srcintf="port3" dstip=216.58.210.174 dstport=443 dstintf="port7" sessionid=128625552 proto=6 action=close policyid=39 dstcountry="United States" srccountry="Reserved" trandisp=noop service="HTTPS" duration=241 sentbyte=132 rcvdbyte=92 sentpkt=3 rcvdpkt=2 appcat="unscanned"',
    pri: "<189>",
    prival: 189,
    facilityval: 23,
    levelval: 5,
    facility: "local7",
    level: "notice",
    type: "UNKNOWN",
    ts: expect.any(Date),
    host: "192.168.26.254",
    appName: "myApp",
    message:
      'time=16:31:28 devname=FG600B3909601440 devid=FG600B3909601440 logid=0000000013 type=traffic subtype=forward level=notice vd=VDOM-SNOC srcip=192.168.22.68 srcport=51448 srcintf="port3" dstip=216.58.210.174 dstport=443 dstintf="port7" sessionid=128625552 proto=6 action=close policyid=39 dstcountry="United States" srccountry="Reserved" trandisp=noop service="HTTPS" duration=241 sentbyte=132 rcvdbyte=92 sentpkt=3 rcvdpkt=2 appcat="unscanned"',
    chain: [],
    header: "<189>192.168.26.254 myApp ",
  },
  {
    originalMessage:
      '<165>1 2003-10-11T22:14:15.003Z mymachine.example.com evntslog - ID47 [exampleSDID@32473 iut="3" eventSource="Application" eventID="1011"][exampleSDID@32474 iut="4" eventSource="Application" eventID="1012"] BOMAn application event log entry',
    pri: "<165>",
    prival: 165,
    facilityval: 20,
    levelval: 5,
    facility: "local4",
    level: "notice",
    version: 1,
    type: "RFC5424",
    ts: new Date("2003-10-11T22:14:15.003Z"),
    host: "mymachine.example.com",
    appName: "evntslog",
    pid: "-",
    messageid: "ID47",
    message: "BOMAn application event log entry",
    chain: [],
    structuredData: [
      {
        $id: "exampleSDID@32473",
        iut: "3",
        eventSource: "Application",
        eventID: "1011",
      },
      {
        $id: "exampleSDID@32474",
        iut: "4",
        eventSource: "Application",
        eventID: "1012",
      },
    ],
    header:
      "<165>1 2003-10-11T22:14:15.003Z mymachine.example.com evntslog - ID47 ",
    fields: [],
  },
  {
    originalMessage:
      "<30>May  8 00:01:01 logica5_engine6 systemd: Starting Session 63 of user root.",
    pri: "<30>",
    prival: 30,
    facilityval: 3,
    levelval: 6,
    facility: "daemon",
    level: "info",
    type: "BSD",
    ts: dateAsCurrentYear("2019-05-07T23:01:01.000Z"),
    host: "logica5_engine6",
    appName: "systemd",
    message: "Starting Session 63 of user root.",
    chain: [],
    fields: [],
    header: "<30>May  8 00:01:01 logica5_engine6 systemd: ",
  },
  {
    originalMessage:
      "<13>May 9 11:41:08 192.168.110.11 MSWinEventLog 1 ||{54849625-5478-4994-A5BA-3E3B0328C30D}||Microsoft-Windows",
    pri: "<13>",
    prival: 13,
    facilityval: 1,
    levelval: 5,
    facility: "user",
    level: "notice",
    type: "BSD",
    ts: dateAsCurrentYear("2019-05-09T10:41:08.000Z"),
    host: "192.168.110.11",
    appName: "MSWinEventLog",
    pid: "1",
    message: "||{54849625-5478-4994-A5BA-3E3B0328C30D}||Microsoft-Windows",
    chain: [],
    fields: [],
    header: "<13>May 9 11:41:08 192.168.110.11 MSWinEventLog 1 ",
  },
  {
    originalMessage:
      "Jun 15 17:13:50 192.168.17.72 MSWinEventLog 1 ||||MsiInstaller||11707||0||Información||Ninguna||||Clásico||2010/06/15 17:13:50||381||||||0||0||0||0|| ||Application||WIN-ZARKLN8SUVH||Administrador||Producto: Microsoft .NET Framework 3.5 -- La instalación se completó correctamente.;(NULL);(NULL);;||Producto: Microsoft .NET Framework 3.5 -- La instalación se completó correctamente.",
    pri: "",
    prival: null,
    type: "BSD",
    ts: dateAsCurrentYear("2019-06-15T16:13:50.000Z"),
    host: "192.168.17.72",
    appName: "MSWinEventLog",
    pid: "1",
    message:
      "||||MsiInstaller||11707||0||Información||Ninguna||||Clásico||2010/06/15 17:13:50||381||||||0||0||0||0|| ||Application||WIN-ZARKLN8SUVH||Administrador||Producto: Microsoft .NET Framework 3.5 -- La instalación se completó correctamente.;(NULL);(NULL);;||Producto: Microsoft .NET Framework 3.5 -- La instalación se completó correctamente.",
    chain: [],
    fields: [],
    header: "Jun 15 17:13:50 192.168.17.72 MSWinEventLog 1 ",
  },
  {
    originalMessage:
      "<13>May  9 16:56:32 192.168.110.12 MSWinEventLog 1 ||{54849625-5478-4994-A5BA-3E3B0328C30D}||Microsoft-Windows-Security-Auditing||4634||0||Informaciï¿½n||||Informaciï¿½n||Auditorï¿½a correcta||2017-05-09 16:56:32||267119563||||||492||384||0||0|| ||Security||GICA-DC-02.acmeco.local||||S-1-5-21-1549636476-3519663633-904275800-7216;GVDI-SEV-010$;acmeco;1C5B0D9Fh;3||Se cerrï¿½ sesiï¿½n en una cuenta.    Sujeto:  \tId. de seguridad:\t\tS-1-5-21-1549636476-3519663633-904275800-7216  \tNombre de cuenta:\t\tGVDI-SEV-010$  \tDominio de cuenta:\t\tacmeco  \tId. de inicio de sesiï¿½n:\t\t0x1c5b0d9f    Tipo de inicio de sesiï¿½n:\t\t\t3    Este evento se genera cuando se destruye una sesiï¿½n de inicio. Puede estar correlacionado de manera positiva con un evento de inicio de sesiï¿½n mediante el valor Id. de inicio de sesiï¿½n. Los id. de inicio de sesiï¿½n sï¿½lo son ï¿½nicos entre reinicios en el mismo equipo.\n",
    pri: "<13>",
    prival: 13,
    facilityval: 1,
    levelval: 5,
    facility: "user",
    level: "notice",
    type: "BSD",
    ts: dateAsCurrentYear("2019-05-09T15:56:32.000Z"),
    host: "192.168.110.12",
    appName: "MSWinEventLog",
    pid: "1",
    message:
      "||{54849625-5478-4994-A5BA-3E3B0328C30D}||Microsoft-Windows-Security-Auditing||4634||0||Informaciï¿½n||||Informaciï¿½n||Auditorï¿½a correcta||2017-05-09 16:56:32||267119563||||||492||384||0||0|| ||Security||GICA-DC-02.acmeco.local||||S-1-5-21-1549636476-3519663633-904275800-7216;GVDI-SEV-010$;acmeco;1C5B0D9Fh;3||Se cerrï¿½ sesiï¿½n en una cuenta.    Sujeto:  \tId. de seguridad:\t\tS-1-5-21-1549636476-3519663633-904275800-7216  \tNombre de cuenta:\t\tGVDI-SEV-010$  \tDominio de cuenta:\t\tacmeco  \tId. de inicio de sesiï¿½n:\t\t0x1c5b0d9f    Tipo de inicio de sesiï¿½n:\t\t\t3    Este evento se genera cuando se destruye una sesiï¿½n de inicio. Puede estar correlacionado de manera positiva con un evento de inicio de sesiï¿½n mediante el valor Id. de inicio de sesiï¿½n. Los id. de inicio de sesiï¿½n sï¿½lo son ï¿½nicos entre reinicios en el mismo equipo.",
    chain: [],
    fields: [],
    header: "<13>May  9 16:56:32 192.168.110.12 MSWinEventLog 1 ",
  },
  {
    originalMessage:
      '<7>1 2017-05-11T14:45:31.995+02:00 logica5p storm1 - - - 192.168.120.172 - - [04/Nov/2015:15:11:33 +0100] "GET /localclassifieds//classifieds/Site_Admin/admin.php  HTTP/1.1" 404 1137 "-" "Mozilla/5.0 [en] (X11, U; OpenVAS 7.0.2)"',
    pri: "<7>",
    prival: 7,
    facilityval: 0,
    levelval: 7,
    facility: "kern",
    level: "debug",
    version: 1,
    type: "RFC5424",
    ts: new Date("2017-05-11T12:45:31.995Z"),
    host: "logica5p",
    appName: "storm1",
    pid: "-",
    messageid: "-",
    structuredData: [],
    message:
      '192.168.120.172 - - [04/Nov/2015:15:11:33 +0100] "GET /localclassifieds//classifieds/Site_Admin/admin.php  HTTP/1.1" 404 1137 "-" "Mozilla/5.0 [en] (X11, U; OpenVAS 7.0.2)"',
    chain: [],
    header: "<7>1 2017-05-11T14:45:31.995+02:00 logica5p storm1 - - - ",
    fields: [],
  },
  {
    originalMessage:
      "May 06 10:05:03 CCLogTap::profileRemoved, Owner: com.apple.iokit.IO80211Family, Name: IO80211AWDLPeerManager",
    pri: "",
    prival: null,
    type: "BSD",
    ts: dateAsCurrentYear("2019-05-06T09:05:03.000Z"),
    message:
      "CCLogTap::profileRemoved, Owner: com.apple.iokit.IO80211Family, Name: IO80211AWDLPeerManager",
    chain: [],
    host: "",
    fields: [],
    header: "May 06 10:05:03 ",
  },
  {
    originalMessage:
      '<110>1 2009-05-03T14:00:39.529966+02:00 host.example.org/relay.example.org syslogd 2138 - [exampleSDID@32473 iut="3" eventSource="Application" eventID="1011"][exampleSDID@32474 iut="4" eventSource="Application" eventID="1012"][ssign VER="0111" RSID="1" SG="0" SPRI="0" GBC="2" FMN="1" CNT="7" HB="K6wzcombEvKJ+UTMcn9bPryAeaU= zrkDcIeaDluypaPCY8WWzwHpPok= zgrWOdpx16ADc7UmckyIFY53icE= XfopJ+S8/hODapiBBCgVQaLqBKg= J67gKMFl/OauTC20ibbydwIlJC8= M5GziVgB6KPY3ERU1HXdSi2vtdw= Wxd/lU7uG/ipEYT9xeqnsfohyH0=" SIGN="AKBbX4J7QkrwuwdbV7Taujk2lvOf8gCgC62We1QYfnrNHz7FzAvdySuMyfM="] BOMAn application event log entry',
    pri: "<110>",
    prival: 110,
    facilityval: 13,
    levelval: 6,
    facility: "security",
    level: "info",
    version: 1,
    type: "RFC5424",
    ts: new Date("2009-05-03T12:00:39.529Z"),
    host: "relay.example.org",
    appName: "syslogd",
    pid: "2138",
    messageid: "-",
    message: "BOMAn application event log entry",
    chain: ["host.example.org"],
    structuredData: [
      {
        $id: "exampleSDID@32473",
        iut: "3",
        eventSource: "Application",
        eventID: "1011",
      },
      {
        $id: "exampleSDID@32474",
        iut: "4",
        eventSource: "Application",
        eventID: "1012",
      },
      {
        $id: "ssign",
        VER: "0111",
        RSID: "1",
        SG: "0",
        SPRI: "0",
        GBC: "2",
        FMN: "1",
        CNT: "7",
        HB: "K6wzcombEvKJ+UTMcn9bPryAeaU= zrkDcIeaDluypaPCY8WWzwHpPok= zgrWOdpx16ADc7UmckyIFY53icE= XfopJ+S8/hODapiBBCgVQaLqBKg= J67gKMFl/OauTC20ibbydwIlJC8= M5GziVgB6KPY3ERU1HXdSi2vtdw= Wxd/lU7uG/ipEYT9xeqnsfohyH0=",
        SIGN: "AKBbX4J7QkrwuwdbV7Taujk2lvOf8gCgC62We1QYfnrNHz7FzAvdySuMyfM=",
      },
    ],
    header:
      "<110>1 2009-05-03T14:00:39.529966+02:00 host.example.org/relay.example.org syslogd 2138 - ",
    fields: [],
  },
  {
    originalMessage:
      '<163>8,3,00000002-0002-0002-0002-000000028629,00000001-0001-0001-0001-000000028629,"28629: SMB: Microsoft Windows Search Service Memory Corruption Vulnerability",28629,"tcp",172.19.215.118,65409,172.22.215.36,445,1,11A,11B,25,0,"madips5k01",33497931,1497449283018, ,5757687',
    pri: "<163>",
    prival: 163,
    facilityval: 20,
    levelval: 3,
    facility: "local4",
    level: "error",
    type: "UNKNOWN",
    ts: expect.any(Date),
    message:
      '8,3,00000002-0002-0002-0002-000000028629,00000001-0001-0001-0001-000000028629,"28629: SMB: Microsoft Windows Search Service Memory Corruption Vulnerability",28629,"tcp",172.19.215.118,65409,172.22.215.36,445,1,11A,11B,25,0,"madips5k01",33497931,1497449283018, ,5757687',
    chain: [],
    host: "",
    header: "<163>",
  },
  {
    originalMessage:
      "<20>Jun 15 12:33:52 Syslog_LogICAV: Warning: Received an invalid DNS Response: rcode=ServFail data=\"'F\\\\x15\\\\x81\\\\x82\\\\x00\\\\x01\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x06health\\\\x03gov\\\\x02bh\\\\x00\\\\x00\\\\x0f\\\\x00\\\\x01'\" to IP 172.22.204.220 looking up health.gov.bh",
    pri: "<20>",
    prival: 20,
    facilityval: 2,
    levelval: 4,
    facility: "mail",
    level: "warn",
    type: "BSD",
    ts: dateAsCurrentYear("2019-06-15T11:33:52.000Z"),
    host: "Syslog_LogICAV",
    message:
      "Warning: Received an invalid DNS Response: rcode=ServFail data=\"'F\\\\x15\\\\x81\\\\x82\\\\x00\\\\x01\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x06health\\\\x03gov\\\\x02bh\\\\x00\\\\x00\\\\x0f\\\\x00\\\\x01'\" to IP 172.22.204.220 looking up health.gov.bh",
    chain: [],
    fields: [],
    header: "<20>Jun 15 12:33:52 Syslog_LogICAV: ",
  },
  {
    originalMessage:
      "<13>Jul 14 10:10:39 172.22.208.24 MSWinEventLog 1 ||{54849625-5478-4994-A5BA-3E3B0328C30D}||Microsoft-Windows-Security-Auditing||4634||0||Information||||Info||Audit Success||2017-07-14 10:10:39||1123805||||||612||2192||0||0|| ||Security||madcpvflexaprtl.acme.es||||S-1-5-21-1506503333-1133455874-5522801-237819;usrnnmi;acme;E8CB665h;3||An account was logged off.    Subject:  \tSecurity ID:\t\tS-1-5-21-1506503333-1133455874-5522801-237819  \tAccount Name:\t\tusrnnmi  \tAccount Domain:\t\tacme  \tLogon ID:\t\t0xE8CB665    Logon Type:\t\t\t3    This event is generated when a logon session is destroyed. It may be positively correlated with a logon event using the Logon ID value. Logon IDs are only unique between reboots on the same computer.\n",
    pri: "<13>",
    prival: 13,
    facilityval: 1,
    levelval: 5,
    facility: "user",
    level: "notice",
    type: "BSD",
    ts: dateAsCurrentYear("2019-07-14T09:10:39.000Z"),
    host: "172.22.208.24",
    appName: "MSWinEventLog",
    pid: "1",
    message:
      "||{54849625-5478-4994-A5BA-3E3B0328C30D}||Microsoft-Windows-Security-Auditing||4634||0||Information||||Info||Audit Success||2017-07-14 10:10:39||1123805||||||612||2192||0||0|| ||Security||madcpvflexaprtl.acme.es||||S-1-5-21-1506503333-1133455874-5522801-237819;usrnnmi;acme;E8CB665h;3||An account was logged off.    Subject:  \tSecurity ID:\t\tS-1-5-21-1506503333-1133455874-5522801-237819  \tAccount Name:\t\tusrnnmi  \tAccount Domain:\t\tacme  \tLogon ID:\t\t0xE8CB665    Logon Type:\t\t\t3    This event is generated when a logon session is destroyed. It may be positively correlated with a logon event using the Logon ID value. Logon IDs are only unique between reboots on the same computer.",
    chain: [],
    fields: [],
    header: "<13>Jul 14 10:10:39 172.22.208.24 MSWinEventLog 1 ",
  },
  {
    originalMessage:
      "Sep 14 00:41:58 MADARRBCKOC MSWinEventLog 1 ||{54849625-5478-4994-A5BA-3E3B0328C30D}||Microsoft-Windows-Security-Auditing||4672||0||Information||||Info||Audit Success||2017-09-14 00:41:58||154144||||||568||4612||0||0|| ||Security||madarrbckoc.acme.es||||S-1-5-18;MADARRBCKOC$;acme;309CE194h;SeSecurityPrivilege  \t\t\tSeBackupPrivilege  \t\t\tSeRestorePrivilege  \t\t\tSeTakeOwnershipPrivilege  \t\t\tSeDebugPrivilege  \t\t\tSeSystemEnvironmentPrivilege  \t\t\tSeLoadDriverPrivilege  \t\t\tSeImpersonatePrivilege||Special privileges assigned to new logon.    Subject:  \tSecurity ID:\t\tS-1-5-18  \tAccount Name:\t\tMADARRBCKOC$  \tAccount Domain:\t\tacme  \tLogon ID:\t\t0x309ce194    Privileges:\t\tSeSecurityPrivilege  \t\t\tSeBackupPrivilege  \t\t\tSeRestorePrivilege  \t\t\tSeTakeOwnershipPrivilege  \t\t\tSeDebugPrivilege  \t\t\tSeSystemEnvironmentPrivilege  \t\t\tSeLoadDriverPrivilege  \t\t\tSeImpersonatePrivilege",
    pri: "",
    prival: null,
    type: "BSD",
    ts: dateAsCurrentYear("2019-09-13T23:41:58.000Z"),
    host: "MADARRBCKOC",
    appName: "MSWinEventLog",
    pid: "1",
    message:
      "||{54849625-5478-4994-A5BA-3E3B0328C30D}||Microsoft-Windows-Security-Auditing||4672||0||Information||||Info||Audit Success||2017-09-14 00:41:58||154144||||||568||4612||0||0|| ||Security||madarrbckoc.acme.es||||S-1-5-18;MADARRBCKOC$;acme;309CE194h;SeSecurityPrivilege  \t\t\tSeBackupPrivilege  \t\t\tSeRestorePrivilege  \t\t\tSeTakeOwnershipPrivilege  \t\t\tSeDebugPrivilege  \t\t\tSeSystemEnvironmentPrivilege  \t\t\tSeLoadDriverPrivilege  \t\t\tSeImpersonatePrivilege||Special privileges assigned to new logon.    Subject:  \tSecurity ID:\t\tS-1-5-18  \tAccount Name:\t\tMADARRBCKOC$  \tAccount Domain:\t\tacme  \tLogon ID:\t\t0x309ce194    Privileges:\t\tSeSecurityPrivilege  \t\t\tSeBackupPrivilege  \t\t\tSeRestorePrivilege  \t\t\tSeTakeOwnershipPrivilege  \t\t\tSeDebugPrivilege  \t\t\tSeSystemEnvironmentPrivilege  \t\t\tSeLoadDriverPrivilege  \t\t\tSeImpersonatePrivilege",
    chain: [],
    fields: [],
    header: "Sep 14 00:41:58 MADARRBCKOC MSWinEventLog 1 ",
  },
  {
    originalMessage:
      "CEF:0|security|threatmanager|1.0|100|detected a \\| in message|10|src=10.0.0.1 act=blocked a | dst=1.1.1.1",
    pri: "",
    prival: null,
    type: "CEF",
    ts: expect.any(Date),
    message:
      "CEF:0|security|threatmanager|1.0|100|detected a \\| in message|10|src=10.0.0.1 act=blocked a | dst=1.1.1.1",
    chain: [],
    host: "",
    cef: {
      version: "CEF:0",
      deviceVendor: "security",
      deviceProduct: "threatmanager",
      deviceVersion: "1.0",
      deviceEventClassID: "100",
      name: "detected a | in message",
      severity: "10",
      extension: "src=10.0.0.1 act=blocked a | dst=1.1.1.1",
    },
    fields: {
      src: "10.0.0.1",
      act: "blocked a |",
      dst: "1.1.1.1",
    },
    header: "",
  },
  {
    originalMessage:
      "Sep 19 08:26:10 host CEF:0|security|threatmanager|1.0|100|detected a \\\\ in packet|10|src=10.0.0.1 act=blocked a \\\\ dst=1.1.1.1",
    pri: "",
    prival: null,
    type: "CEF",
    ts: dateAsCurrentYear("2019-09-19T07:26:10.000Z"),
    host: "host",
    message:
      "CEF:0|security|threatmanager|1.0|100|detected a \\\\ in packet|10|src=10.0.0.1 act=blocked a \\\\ dst=1.1.1.1",
    chain: [],
    cef: {
      version: "CEF:0",
      deviceVendor: "security",
      deviceProduct: "threatmanager",
      deviceVersion: "1.0",
      deviceEventClassID: "100",
      name: "detected a \\ in packet",
      severity: "10",
      extension: "src=10.0.0.1 act=blocked a \\\\ dst=1.1.1.1",
    },
    fields: {
      src: "10.0.0.1",
      act: "blocked a \\",
      dst: "1.1.1.1",
    },
    header: "Sep 19 08:26:10 host ",
  },
  {
    originalMessage:
      "Sep 19 08:26:10 host CEF:0|security|threatmanager|1.0|100|Detected a threat. No action needed.|10|src=10.0.0.1 msg=Detected a threat.\\n No action needed.",
    pri: "",
    prival: null,
    type: "CEF",
    ts: dateAsCurrentYear("2019-09-19T07:26:10.000Z"),
    host: "host",
    message:
      "CEF:0|security|threatmanager|1.0|100|Detected a threat. No action needed.|10|src=10.0.0.1 msg=Detected a threat.\\n No action needed.",
    chain: [],
    cef: {
      version: "CEF:0",
      deviceVendor: "security",
      deviceProduct: "threatmanager",
      deviceVersion: "1.0",
      deviceEventClassID: "100",
      name: "Detected a threat. No action needed.",
      severity: "10",
      extension: "src=10.0.0.1 msg=Detected a threat.\\n No action needed.",
    },
    fields: {
      src: "10.0.0.1",
      msg: "Detected a threat.\n No action needed.",
    },
    header: "Sep 19 08:26:10 host ",
  },
  {
    originalMessage:
      "Sep 19 08:26:10 host CEF:0|security|threatmanager|1.0|100|detected a = in message|10|src=10.0.0.1 act=blocked a \\= dst=1.1.1.1",
    pri: "",
    prival: null,
    type: "CEF",
    ts: dateAsCurrentYear("2019-09-19T07:26:10.000Z"),
    host: "host",
    message:
      "CEF:0|security|threatmanager|1.0|100|detected a = in message|10|src=10.0.0.1 act=blocked a \\= dst=1.1.1.1",
    chain: [],
    cef: {
      version: "CEF:0",
      deviceVendor: "security",
      deviceProduct: "threatmanager",
      deviceVersion: "1.0",
      deviceEventClassID: "100",
      name: "detected a = in message",
      severity: "10",
      extension: "src=10.0.0.1 act=blocked a \\= dst=1.1.1.1",
    },
    fields: {
      src: "10.0.0.1",
      act: "blocked a =",
      dst: "1.1.1.1",
    },
    header: "Sep 19 08:26:10 host ",
  },
  {
    originalMessage:
      "Jan 18 11:07:53 dsmhost CEF:0|Trend Micro|Deep Security Manager|<DSM version>|600|User Signed In|3|src=10.52.116.160 suser=admin target=admin msg=User signed in from 2001:db8::5",
    pri: "",
    prival: null,
    type: "CEF",
    ts: dateAsCurrentYear("2019-01-18T11:07:53.000Z"),
    host: "dsmhost",
    message:
      "CEF:0|Trend Micro|Deep Security Manager|<DSM version>|600|User Signed In|3|src=10.52.116.160 suser=admin target=admin msg=User signed in from 2001:db8::5",
    chain: [],
    cef: {
      version: "CEF:0",
      deviceVendor: "Trend Micro",
      deviceProduct: "Deep Security Manager",
      deviceVersion: "<DSM version>",
      deviceEventClassID: "600",
      name: "User Signed In",
      severity: "3",
      extension:
        "src=10.52.116.160 suser=admin target=admin msg=User signed in from 2001:db8::5",
    },
    fields: {
      src: "10.52.116.160",
      suser: "admin",
      target: "admin",
      msg: "User signed in from 2001:db8::5",
    },
    header: "Jan 18 11:07:53 dsmhost ",
  },
  {
    originalMessage:
      "<30>1 2018-06-24T22:22:53Z my.test.com testapp 26599 testapp - This: contains two : colons",
    pri: "<30>",
    prival: 30,
    facilityval: 3,
    levelval: 6,
    facility: "daemon",
    level: "info",
    version: 1,
    type: "RFC5424",
    ts: new Date("2018-06-24T22:22:53.000Z"),
    host: "my.test.com",
    appName: "testapp",
    pid: "26599",
    messageid: "testapp",
    structuredData: [],
    message: "This: contains two : colons",
    chain: [],
    fields: [],
    header: "<30>1 2018-06-24T22:22:53Z my.test.com testapp 26599 testapp - ",
  },
  {
    originalMessage:
      "<30>Aug  4 16:53:13 pinger[1334]: 64 bytes from 87.250.250.242: seq=69 ttl=37 time=33.918 ms\n",
    pri: "<30>",
    prival: 30,
    facilityval: 3,
    levelval: 6,
    facility: "daemon",
    level: "info",
    type: "BSD",
    ts: dateAsCurrentYear("2019-08-04T15:53:13.000Z"),
    host: "pinger[1334]",
    message: "64 bytes from 87.250.250.242: seq=69 ttl=37 time=33.918 ms",
    chain: [],
    fields: [],
    header: "<30>Aug  4 16:53:13 pinger[1334]: ",
  },
  {
    originalMessage:
      "<190>AMP (airwave)[6944]: Your license does not allow you to create or authorize additional APs/Devices\tSystem\tSystem\t\t\t",
    pri: "<190>",
    prival: 190,
    facilityval: 23,
    levelval: 6,
    facility: "local7",
    level: "info",
    type: "UNKNOWN",
    ts: expect.any(Date),
    host: "AMP",
    appName: "(airwave)",
    message:
      "Your license does not allow you to create or authorize additional APs/Devices\tSystem\tSystem",
    chain: [],
    header: "<190>AMP (airwave)[6944]: ",
    pid: "6944",
  },
  {
    originalMessage:
      '<189>date=2018-09-13 time=10:12:18 devname=FW-310B-01 devid=FG300B3911601588 logid=0000000013 type=traffic subtype=forward level=notice vd=root srcip=10.67.24.31 srcport=49853 srcintf="WIFI_XXX" dstip=173.194.76.188 dstport=5228 dstintf="FW-310B_HP-8206" sessionid=4732460 proto=6 action=timeout policyid=37 dstcountry="United States" srccountry="Reserved" trandisp=noop service="tcp/5228" duration=39 sentbyte=156 rcvdbyte=0 sentpkt=3 rcvdpkt=0 appcat="unscanned" crscore=5 craction=262144 crlevel=low',
    pri: "<189>",
    prival: 189,
    facilityval: 23,
    levelval: 5,
    facility: "local7",
    level: "notice",
    type: "UNKNOWN",
    ts: expect.any(Date),
    message:
      'date=2018-09-13 time=10:12:18 devname=FW-310B-01 devid=FG300B3911601588 logid=0000000013 type=traffic subtype=forward level=notice vd=root srcip=10.67.24.31 srcport=49853 srcintf="WIFI_XXX" dstip=173.194.76.188 dstport=5228 dstintf="FW-310B_HP-8206" sessionid=4732460 proto=6 action=timeout policyid=37 dstcountry="United States" srccountry="Reserved" trandisp=noop service="tcp/5228" duration=39 sentbyte=156 rcvdbyte=0 sentpkt=3 rcvdpkt=0 appcat="unscanned" crscore=5 craction=262144 crlevel=low',
    chain: [],
    host: "",
    header: "<189>",
  },
  {
    originalMessage:
      '<189>date=2018-09-13 time=10:12:18 devname=FW-310B-01 devid=FG300B3911601588 logid=0000000013 type=traffic subtype=forward level=notice vd=root srcip=192.168.134.9 srcport=58335 srcintf="WIFI_INVITADOS" dstip=104.36.251.158 dstport=443 dstintf="port8" sessionid=4733602 proto=6 action=close policyid=40 dstcountry="United States" srccountry="Reserved" trandisp=snat transip=192.168.98.6 transport=58335 service="HTTPS" duration=1 sentbyte=132 rcvdbyte=92 sentpkt=3 rcvdpkt=2 appcat="unscanned"',
    pri: "<189>",
    prival: 189,
    facilityval: 23,
    levelval: 5,
    facility: "local7",
    level: "notice",
    type: "UNKNOWN",
    ts: expect.any(Date),
    message:
      'date=2018-09-13 time=10:12:18 devname=FW-310B-01 devid=FG300B3911601588 logid=0000000013 type=traffic subtype=forward level=notice vd=root srcip=192.168.134.9 srcport=58335 srcintf="WIFI_INVITADOS" dstip=104.36.251.158 dstport=443 dstintf="port8" sessionid=4733602 proto=6 action=close policyid=40 dstcountry="United States" srccountry="Reserved" trandisp=snat transip=192.168.98.6 transport=58335 service="HTTPS" duration=1 sentbyte=132 rcvdbyte=92 sentpkt=3 rcvdpkt=2 appcat="unscanned"',
    chain: [],
    host: "",
    header: "<189>",
  },
  {
    originalMessage:
      '<189>date=2018-09-13 time=10:12:18 devname=FW-310B-01 devid=FG300B3911601588 logid=0001000014 type=traffic subtype=local level=notice vd=root srcip=10.67.24.31 srcport=137 srcintf="WIFI_XXX" dstip=10.67.24.255 dstport=137 dstintf=unknown-0 sessionid=4733634 proto=17 action=deny policyid=0 dstcountry="Reserved" srccountry="Reserved" trandisp=noop service="SMB1" app="netbios forward" duration=0 sentbyte=0 rcvdbyte=0 sentpkt=0 appcat="unscanned"',
    pri: "<189>",
    prival: 189,
    facilityval: 23,
    levelval: 5,
    facility: "local7",
    level: "notice",
    type: "UNKNOWN",
    ts: expect.any(Date),
    message:
      'date=2018-09-13 time=10:12:18 devname=FW-310B-01 devid=FG300B3911601588 logid=0001000014 type=traffic subtype=local level=notice vd=root srcip=10.67.24.31 srcport=137 srcintf="WIFI_XXX" dstip=10.67.24.255 dstport=137 dstintf=unknown-0 sessionid=4733634 proto=17 action=deny policyid=0 dstcountry="Reserved" srccountry="Reserved" trandisp=noop service="SMB1" app="netbios forward" duration=0 sentbyte=0 rcvdbyte=0 sentpkt=0 appcat="unscanned"',
    chain: [],
    host: "",
    header: "<189>",
  },
  {
    originalMessage:
      '<189>date=2018-09-13 time=10:12:18 devname=FW-310B-01 devid=FG300B3911601588 logid=0000000013 type=traffic subtype=forward level=notice vd=root srcip=10.13.179.169 srcport=55386 srcintf="FW-310B_HP-8206" dstip=10.67.24.16 dstport=7680 dstintf="WIFI_XXX" sessionid=4733609 proto=6 action=close policyid=42 dstcountry="Reserved" srccountry="Reserved" trandisp=noop service="tcp/7680" duration=1 sentbyte=52 rcvdbyte=40 sentpkt=1 rcvdpkt=1 appcat="unscanned"',
    pri: "<189>",
    prival: 189,
    facilityval: 23,
    levelval: 5,
    facility: "local7",
    level: "notice",
    type: "UNKNOWN",
    ts: expect.any(Date),
    message:
      'date=2018-09-13 time=10:12:18 devname=FW-310B-01 devid=FG300B3911601588 logid=0000000013 type=traffic subtype=forward level=notice vd=root srcip=10.13.179.169 srcport=55386 srcintf="FW-310B_HP-8206" dstip=10.67.24.16 dstport=7680 dstintf="WIFI_XXX" sessionid=4733609 proto=6 action=close policyid=42 dstcountry="Reserved" srccountry="Reserved" trandisp=noop service="tcp/7680" duration=1 sentbyte=52 rcvdbyte=40 sentpkt=1 rcvdpkt=1 appcat="unscanned"',
    chain: [],
    host: "",
    header: "<189>",
  },
  {
    originalMessage:
      '<189>date=2018-09-13 time=10:12:19 devname=FW-310B-01 devid=FG300B3911601588 logid=0000000013 type=traffic subtype=forward level=notice vd=root srcip=10.67.24.32 srcport=62407 srcintf="WIFI_XXX" dstip=10.67.11.102 dstport=53 dstintf="FW-310B_HP-8206" sessionid=4733388 proto=17 action=accept policyid=37 dstcountry="Reserved" srccountry="Reserved" trandisp=noop service="DNS" duration=10 sentbyte=115 rcvdbyte=190 sentpkt=1 rcvdpkt=1 appcat="unscanned"',
    pri: "<189>",
    prival: 189,
    facilityval: 23,
    levelval: 5,
    facility: "local7",
    level: "notice",
    type: "UNKNOWN",
    ts: expect.any(Date),
    message:
      'date=2018-09-13 time=10:12:19 devname=FW-310B-01 devid=FG300B3911601588 logid=0000000013 type=traffic subtype=forward level=notice vd=root srcip=10.67.24.32 srcport=62407 srcintf="WIFI_XXX" dstip=10.67.11.102 dstport=53 dstintf="FW-310B_HP-8206" sessionid=4733388 proto=17 action=accept policyid=37 dstcountry="Reserved" srccountry="Reserved" trandisp=noop service="DNS" duration=10 sentbyte=115 rcvdbyte=190 sentpkt=1 rcvdpkt=1 appcat="unscanned"',
    chain: [],
    host: "",
    header: "<189>",
  },
  {
    originalMessage:
      '<189>date=2018-09-13 time=10:12:19 devname=FW-310B-01 devid=FG300B3911601588 logid=0000000011 type=traffic subtype=forward level=warning vd=root srcip=10.67.24.32 srcport=62407 srcintf="WIFI_XXX" dstip=10.67.11.102 dstport=53 dstintf="FW-310B_HP-8206" sessionid=4733388 proto=17 action=dns policyid=37 appcat="unscanned" crscore=5 craction=262144 crlevel=low',
    pri: "<189>",
    prival: 189,
    facilityval: 23,
    levelval: 5,
    facility: "local7",
    level: "notice",
    type: "UNKNOWN",
    ts: expect.any(Date),
    message:
      'date=2018-09-13 time=10:12:19 devname=FW-310B-01 devid=FG300B3911601588 logid=0000000011 type=traffic subtype=forward level=warning vd=root srcip=10.67.24.32 srcport=62407 srcintf="WIFI_XXX" dstip=10.67.11.102 dstport=53 dstintf="FW-310B_HP-8206" sessionid=4733388 proto=17 action=dns policyid=37 appcat="unscanned" crscore=5 craction=262144 crlevel=low',
    chain: [],
    host: "",
    header: "<189>",
  },
  {
    originalMessage:
      '<189>date=2018-09-13 time=10:12:19 devname=FW-310B-01 devid=FG300B3911601588 logid=0000000013 type=traffic subtype=forward level=notice vd=root srcip=10.67.24.5 srcport=52970 srcintf="WIFI_XXX" dstip=10.13.179.156 dstport=7680 dstintf="FW-310B_HP-8206" sessionid=4733612 proto=6 action=close policyid=37 dstcountry="Reserved" srccountry="Reserved" trandisp=noop service="tcp/7680" duration=1 sentbyte=132 rcvdbyte=92 sentpkt=3 rcvdpkt=2 appcat="unscanned"',
    pri: "<189>",
    prival: 189,
    facilityval: 23,
    levelval: 5,
    facility: "local7",
    level: "notice",
    type: "UNKNOWN",
    ts: expect.any(Date),
    message:
      'date=2018-09-13 time=10:12:19 devname=FW-310B-01 devid=FG300B3911601588 logid=0000000013 type=traffic subtype=forward level=notice vd=root srcip=10.67.24.5 srcport=52970 srcintf="WIFI_XXX" dstip=10.13.179.156 dstport=7680 dstintf="FW-310B_HP-8206" sessionid=4733612 proto=6 action=close policyid=37 dstcountry="Reserved" srccountry="Reserved" trandisp=noop service="tcp/7680" duration=1 sentbyte=132 rcvdbyte=92 sentpkt=3 rcvdpkt=2 appcat="unscanned"',
    chain: [],
    host: "",
    header: "<189>",
  },
  {
    originalMessage:
      '<189>date=2018-09-13 time=10:12:19 devname=FW-310B-01 devid=FG300B3911601588 logid=0000000011 type=traffic subtype=forward level=warning vd=root srcip=10.67.24.32 srcport=52839 srcintf="WIFI_XXX" dstip=10.67.11.102 dstport=53 dstintf="FW-310B_HP-8206" sessionid=4733389 proto=17 action=dns policyid=37 appcat="unscanned" crscore=5 craction=262144 crlevel=low',
    pri: "<189>",
    prival: 189,
    facilityval: 23,
    levelval: 5,
    facility: "local7",
    level: "notice",
    type: "UNKNOWN",
    ts: expect.any(Date),
    message:
      'date=2018-09-13 time=10:12:19 devname=FW-310B-01 devid=FG300B3911601588 logid=0000000011 type=traffic subtype=forward level=warning vd=root srcip=10.67.24.32 srcport=52839 srcintf="WIFI_XXX" dstip=10.67.11.102 dstport=53 dstintf="FW-310B_HP-8206" sessionid=4733389 proto=17 action=dns policyid=37 appcat="unscanned" crscore=5 craction=262144 crlevel=low',
    chain: [],
    host: "",
    header: "<189>",
  },
  {
    originalMessage:
      '<189>date=2018-09-13 time=10:12:19 devname=FW-310B-01 devid=FG300B3911601588 logid=0000000013 type=traffic subtype=forward level=notice vd=root srcip=10.67.24.32 srcport=52839 srcintf="WIFI_XXX" dstip=10.67.11.102 dstport=53 dstintf="FW-310B_HP-8206" sessionid=4733389 proto=17 action=accept policyid=37 dstcountry="Reserved" srccountry="Reserved" trandisp=noop service="DNS" duration=10 sentbyte=90 rcvdbyte=165 sentpkt=1 rcvdpkt=1 appcat="unscanned"',
    pri: "<189>",
    prival: 189,
    facilityval: 23,
    levelval: 5,
    facility: "local7",
    level: "notice",
    type: "UNKNOWN",
    ts: expect.any(Date),
    message:
      'date=2018-09-13 time=10:12:19 devname=FW-310B-01 devid=FG300B3911601588 logid=0000000013 type=traffic subtype=forward level=notice vd=root srcip=10.67.24.32 srcport=52839 srcintf="WIFI_XXX" dstip=10.67.11.102 dstport=53 dstintf="FW-310B_HP-8206" sessionid=4733389 proto=17 action=accept policyid=37 dstcountry="Reserved" srccountry="Reserved" trandisp=noop service="DNS" duration=10 sentbyte=90 rcvdbyte=165 sentpkt=1 rcvdpkt=1 appcat="unscanned"',
    chain: [],
    host: "",
    header: "<189>",
  },
  {
    originalMessage:
      "<143>Sep 12 2018 15:32:19 10.67.3.37 CEF:0|Aruba Networks|ClearPass|6.7.5.108264|2000|Logged in users|1|cat=Session Logs dvc=10.67.3.37 duser=senasa.jcgp destinationServiceName=Wireless_MAC_USUARIOS dpriv=[Employee], [MAC Caching], [User Authenticated] dmac=b49d0b950026 dst=192.168.135.50 src=192.168.131.1 rt=Sep 12 2018 15:32:11",
    pri: "<143>",
    prival: 143,
    facilityval: 17,
    levelval: 7,
    facility: "local1",
    level: "debug",
    type: "CEF",
    ts: new Date("2018-09-12T14:32:19.000Z"),
    message:
      "CEF:0|Aruba Networks|ClearPass|6.7.5.108264|2000|Logged in users|1|cat=Session Logs dvc=10.67.3.37 duser=senasa.jcgp destinationServiceName=Wireless_MAC_USUARIOS dpriv=[Employee], [MAC Caching], [User Authenticated] dmac=b49d0b950026 dst=192.168.135.50 src=192.168.131.1 rt=Sep 12 2018 15:32:11",
    chain: [],
    host: "10.67.3.37",
    fields: {
      cat: "Session Logs",
      destinationServiceName: "Wireless_MAC_USUARIOS",
      dmac: "b49d0b950026",
      dpriv: "[Employee], [MAC Caching], [User Authenticated]",
      dst: "192.168.135.50",
      duser: "senasa.jcgp",
      dvc: "10.67.3.37",
      rt: "Sep 12 2018 15:32:11",
      src: "192.168.131.1",
    },
    header: "<143>Sep 12 2018 15:32:19 10.67.3.37 ",
    cef: {
      deviceEventClassID: "2000",
      deviceProduct: "ClearPass",
      deviceVendor: "Aruba Networks",
      deviceVersion: "6.7.5.108264",
      extension:
        "cat=Session Logs dvc=10.67.3.37 duser=senasa.jcgp destinationServiceName=Wireless_MAC_USUARIOS dpriv=[Employee], [MAC Caching], [User Authenticated] dmac=b49d0b950026 dst=192.168.135.50 src=192.168.131.1 rt=Sep 12 2018 15:32:11",
      name: "Logged in users",
      severity: "1",
      version: "CEF:0",
    },
  },
  {
    originalMessage:
      "<143>Sep 12 2018 15:32:19 10.67.3.37 CEF:0|Aruba Networks|ClearPass|6.7.5.108264|2000|Logged in users|1|cat=Session Logs dvc=10.67.3.37 duser=AVIACIONisdefe.mag destinationServiceName=XXX_Wireless_802.1x_Servicio_Corporativo dpriv=Corporate_Machine, [Machine Authenticated], [Other], [User Authenticated] dmac=f48c50ce757f dst=10.67.24.39 src=192.168.131.1 rt=Sep 12 2018 15:31:37",
    pri: "<143>",
    prival: 143,
    facilityval: 17,
    levelval: 7,
    facility: "local1",
    level: "debug",
    type: "CEF",
    ts: new Date("2018-09-12T14:32:19.000Z"),
    message:
      "CEF:0|Aruba Networks|ClearPass|6.7.5.108264|2000|Logged in users|1|cat=Session Logs dvc=10.67.3.37 duser=AVIACIONisdefe.mag destinationServiceName=XXX_Wireless_802.1x_Servicio_Corporativo dpriv=Corporate_Machine, [Machine Authenticated], [Other], [User Authenticated] dmac=f48c50ce757f dst=10.67.24.39 src=192.168.131.1 rt=Sep 12 2018 15:31:37",
    chain: [],
    host: "10.67.3.37",
    fields: {
      cat: "Session Logs",
      destinationServiceName: "XXX_Wireless_802.1x_Servicio_Corporativo",
      dmac: "f48c50ce757f",
      dpriv:
        "Corporate_Machine, [Machine Authenticated], [Other], [User Authenticated]",
      dst: "10.67.24.39",
      duser: "AVIACIONisdefe.mag",
      dvc: "10.67.3.37",
      rt: "Sep 12 2018 15:31:37",
      src: "192.168.131.1",
    },
    cef: {
      deviceEventClassID: "2000",
      deviceProduct: "ClearPass",
      deviceVendor: "Aruba Networks",
      deviceVersion: "6.7.5.108264",
      extension:
        "cat=Session Logs dvc=10.67.3.37 duser=AVIACIONisdefe.mag destinationServiceName=XXX_Wireless_802.1x_Servicio_Corporativo dpriv=Corporate_Machine, [Machine Authenticated], [Other], [User Authenticated] dmac=f48c50ce757f dst=10.67.24.39 src=192.168.131.1 rt=Sep 12 2018 15:31:37",
      name: "Logged in users",
      severity: "1",
      version: "CEF:0",
    },
    header: "<143>Sep 12 2018 15:32:19 10.67.3.37 ",
  },
  {
    originalMessage:
      "<30>s2413-XXX.aviacion.fomento.es Instancia3[22469]: INFO  17:33:22,521 INFO  [stdout] (http--0.0.0.0-8083-299) 2018-09-25 17:33:22,521 INFO  - es.XXX.dcta.core.ws.consultas.DctaCoreConsultasPortImpl - Finishing operation obtenerConsentimientos | usuario= sed1 count= 2\n",
    pri: "<30>",
    prival: 30,
    facilityval: 3,
    levelval: 6,
    facility: "daemon",
    level: "info",
    type: "UNKNOWN",
    ts: expect.any(Date),
    host: "s2413-XXX.aviacion.fomento.es",
    appName: "Instancia3",
    message:
      "INFO  17:33:22,521 INFO  [stdout] (http--0.0.0.0-8083-299) 2018-09-25 17:33:22,521 INFO  - es.XXX.dcta.core.ws.consultas.DctaCoreConsultasPortImpl - Finishing operation obtenerConsentimientos | usuario= sed1 count= 2",
    chain: [],
    header: "<30>s2413-XXX.aviacion.fomento.es Instancia3[22469]: ",
    pid: "22469",
  },
  {
    originalMessage:
      "<166>Nov  6 13:07:13 MADCPVDS1 CEF:0|Trend Micro|Deep Security Manager|11.0.249|720|Policy Sent|3|src=172.22.225.30 suser=System target=Colbog7mtt msg=The policy (fingerprint 6B:20:C9:33:9C:C9:5D:AD:2C:51:94:67:17:53:E7:68:95:B9:2B:A1) was successfully sent to the agent. TrendMicroDsTenant=Primary TrendMicroDsTenantId=0 ",
    pri: "<166>",
    prival: 166,
    facilityval: 20,
    levelval: 6,
    facility: "local4",
    level: "info",
    type: "CEF",
    ts: dateAsCurrentYear("2019-11-06T13:07:13.000Z"),
    host: "MADCPVDS1",
    message:
      "CEF:0|Trend Micro|Deep Security Manager|11.0.249|720|Policy Sent|3|src=172.22.225.30 suser=System target=Colbog7mtt msg=The policy (fingerprint 6B:20:C9:33:9C:C9:5D:AD:2C:51:94:67:17:53:E7:68:95:B9:2B:A1) was successfully sent to the agent. TrendMicroDsTenant=Primary TrendMicroDsTenantId=0",
    chain: [],
    cef: {
      version: "CEF:0",
      deviceVendor: "Trend Micro",
      deviceProduct: "Deep Security Manager",
      deviceVersion: "11.0.249",
      deviceEventClassID: "720",
      name: "Policy Sent",
      severity: "3",
      extension:
        "src=172.22.225.30 suser=System target=Colbog7mtt msg=The policy (fingerprint 6B:20:C9:33:9C:C9:5D:AD:2C:51:94:67:17:53:E7:68:95:B9:2B:A1) was successfully sent to the agent. TrendMicroDsTenant=Primary TrendMicroDsTenantId=0 ",
    },
    fields: {
      src: "172.22.225.30",
      suser: "System",
      target: "Colbog7mtt",
      msg: "The policy (fingerprint 6B:20:C9:33:9C:C9:5D:AD:2C:51:94:67:17:53:E7:68:95:B9:2B:A1) was successfully sent to the agent.",
      TrendMicroDsTenant: "Primary",
      TrendMicroDsTenantId: "0 ",
    },
    header: "<166>Nov  6 13:07:13 MADCPVDS1 ",
  },
  {
    originalMessage:
      '<33>0 2019-11-07T06:09:28+01:00 destmp.ICA.age Manual - - -  Scanning Finished: Spyware found [alertMeta@0 oid="1.3.6.1.4.1.2213.12.2147483647.104" shost="ICA2827" uid="56d3b8fe-602b-2548-921a-ce1a821e7b31" domainTreePath="Root/ICA.age/ICA/PCs/Alcala/Planta-4/ICA2827" suser="NT AUTHORITYSYSTEM" message="Manual scanning was finished - spyware was found in the system."]',
    pri: "<33>",
    prival: 33,
    facilityval: 4,
    levelval: 1,
    facility: "auth",
    level: "alert",
    version: 0,
    type: "RFC5424",
    ts: new Date("2019-11-07T05:09:28.000Z"),
    host: "destmp.ICA.age",
    appName: "Manual",
    pid: "-",
    messageid: "-",
    structuredData: [
      {
        $id: "alertMeta@0",
        oid: "1.3.6.1.4.1.2213.12.2147483647.104",
        shost: "ICA2827",
        uid: "56d3b8fe-602b-2548-921a-ce1a821e7b31",
        domainTreePath: "Root/ICA.age/ICA/PCs/Alcala/Planta-4/ICA2827",
        suser: "NT AUTHORITYSYSTEM",
        message:
          "Manual scanning was finished - spyware was found in the system.",
      },
    ],
    message: "Scanning Finished: Spyware found",
    chain: [],
    header: "<33>0 2019-11-07T06:09:28+01:00 destmp.ICA.age Manual - - - ",
    fields: [],
  },
  {
    originalMessage:
      '<35>0 2019-11-07T13:34:02+01:00 destmp.ICA.age Reverted - - -  to a backup copy of the incremental policy file [alertMeta@0 oid="1.3.6.1.4.1.2213.11.2147483647.240" shost="CZC8028KZK" uid="32112a5b-d3e6-e784-860c-edfa00d2ab28" domainTreePath="Root/ICA.age/ICA/PCs/Bolivia/Planta-5/CZC8028KZK" suser="ICAijgoni" message="The incremental policy file (policy.ipf) was corrupted and a backup copy of it was successfully taken into use. Some local settings or statistics may have been lost."]',
    pri: "<35>",
    prival: 35,
    facilityval: 4,
    levelval: 3,
    facility: "auth",
    level: "error",
    version: 0,
    type: "RFC5424",
    ts: new Date("2019-11-07T12:34:02.000Z"),
    host: "destmp.ICA.age",
    appName: "Reverted",
    pid: "-",
    messageid: "-",
    structuredData: [
      {
        $id: "alertMeta@0",
        oid: "1.3.6.1.4.1.2213.11.2147483647.240",
        shost: "CZC8028KZK",
        uid: "32112a5b-d3e6-e784-860c-edfa00d2ab28",
        domainTreePath: "Root/ICA.age/ICA/PCs/Bolivia/Planta-5/CZC8028KZK",
        suser: "ICAijgoni",
        message:
          "The incremental policy file (policy.ipf) was corrupted and a backup copy of it was successfully taken into use. Some local settings or statistics may have been lost.",
      },
    ],
    message: "to a backup copy of the incremental policy file",
    chain: [],
    header: "<35>0 2019-11-07T13:34:02+01:00 destmp.ICA.age Reverted - - - ",
    fields: [],
  },
  {
    originalMessage:
      '<35>0 2019-11-07T13:34:02+01:00 destmp.ICA.age Reverted - - -  [alertMeta@0 oid="1.3.6.1.4.1.2213.11.2147483647.240" shost="CZC8028KZK" uid="32112a5b-d3e6-e784-860c-edfa00d2ab28" domainTreePath="Root/ICA.age/ICA/PCs/Bolivia/Planta-5/CZC8028KZK" suser="ICAijgoni" message="The incremental policy file (policy.ipf) was corrupted and a backup copy of it was successfully taken into use. Some local settings or statistics may have been lost."] to a backup copy of the incremental policy file',
    pri: "<35>",
    prival: 35,
    facilityval: 4,
    levelval: 3,
    facility: "auth",
    level: "error",
    version: 0,
    type: "RFC5424",
    ts: new Date("2019-11-07T12:34:02.000Z"),
    host: "destmp.ICA.age",
    appName: "Reverted",
    pid: "-",
    messageid: "-",
    structuredData: [
      {
        $id: "alertMeta@0",
        oid: "1.3.6.1.4.1.2213.11.2147483647.240",
        shost: "CZC8028KZK",
        uid: "32112a5b-d3e6-e784-860c-edfa00d2ab28",
        domainTreePath: "Root/ICA.age/ICA/PCs/Bolivia/Planta-5/CZC8028KZK",
        suser: "ICAijgoni",
        message:
          "The incremental policy file (policy.ipf) was corrupted and a backup copy of it was successfully taken into use. Some local settings or statistics may have been lost.",
      },
    ],
    message: "to a backup copy of the incremental policy file",
    chain: [],
    header: "<35>0 2019-11-07T13:34:02+01:00 destmp.ICA.age Reverted - - - ",
    fields: [],
  },
  {
    originalMessage:
      '<36>0 2019-11-12T17:57:55+01:00 ICA.domini.age Unmanaged - - -  hosts discovered [alertMeta@0 oid="1.3.6.1.4.1.2213.84.2147483647.30" shost="ICA.domini.age" uid="ICA.domini.age" domainTreePath="" message="91 unmanaged host(s) discovered."]',
    pri: "<36>",
    prival: 36,
    facilityval: 4,
    levelval: 4,
    facility: "auth",
    level: "warn",
    version: 0,
    type: "RFC5424",
    ts: new Date("2019-11-12T16:57:55.000Z"),
    host: "ICA.domini.age",
    appName: "Unmanaged",
    pid: "-",
    messageid: "-",
    structuredData: [
      {
        $id: "alertMeta@0",
        oid: "1.3.6.1.4.1.2213.84.2147483647.30",
        shost: "ICA.domini.age",
        uid: "ICA.domini.age",
        domainTreePath: "",
        message: "91 unmanaged host(s) discovered.",
      },
    ],
    message: "hosts discovered",
    chain: [],
    header: "<36>0 2019-11-12T17:57:55+01:00 ICA.domini.age Unmanaged - - - ",
    fields: [],
  },
])("Test cases", (parsed) => {
  let res = parser(parsed.originalMessage);

  expect(res).toEqual(parsed);
});
