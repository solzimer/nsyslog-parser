{"version":3,"sources":["nsyslog-parser.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","module","$","parser","NSyslog","parse","window","FRX","CEP_FIELDS","splitHeaders","text","arr","map","scape","fields","curr","split","forEach","ch","push","splitFields","txt","tokens","res","exec","tok","idx","index","substring","trim","k","shift","v","join","headers","extension","Pri","CEF","RXS","DOPS","cef","pid","peek","item","undefined","assign","entry","host","appName","messageid","structuredData","line","opts","pri","match","originalMessage","prival","parseInt","get","facilityval","facility","levelval","level","FACILITY","id","LEVEL","NaN","items","endparse","prinmr","version","type","ts","Date","month","day","time","year","getYear","unshift","invalidate","message","endsWith","eitem","replace","invalid","chain","pop","sdata","nokeys","lastKey","indexOf","kv","test","prop","header","err","label","FACILITY_MAP","LEVEL_MAP","l","LEVELS","FACILITIES","val1","val2"],"mappings":"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","file":"nsyslog-parser.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\r\n\r\n(function($) {\r\n\tvar parser = require(\"./parser.js\");\r\n\t$.NSyslog = $.NSyslog || {};\r\n\t$.NSyslog.parse = parser;\r\n})(window);\r\n\n},{\"./parser.js\":3}],2:[function(require,module,exports){\nconst FRX = /[a-zA-Z][a-zA-Z0-9]+=/;\r\nconst CEP_FIELDS = [\r\n\t\"version\",\r\n\t\"deviceVendor\",\r\n\t\"deviceProduct\",\r\n\t\"deviceVersion\",\r\n\t\"deviceEventClassID\",\r\n\t\"name\",\r\n\t\"severity\",\r\n\t\"extension\"\r\n]\r\n\r\nfunction splitHeaders(text) {\r\n\tvar arr = [], map = {};\r\n\tvar scape = false;\r\n\tvar fields = 7;\r\n\tvar curr = \"\";\r\n\r\n\ttext.split(\"\").forEach(ch=>{\r\n\t\tif(!fields) {\r\n\t\t\tcurr += ch;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(ch==\"|\") {\r\n\t\t\t\tif(scape) {\r\n\t\t\t\t\tscape = false;\r\n\t\t\t\t\tcurr += ch;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tarr.push(curr);\r\n\t\t\t\t\tcurr = \"\";\r\n\t\t\t\t\tfields--;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if(ch==\"\\\\\") {\r\n\t\t\t\tcurr += ch;\r\n\t\t\t\tscape = !scape;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tscape = false;\r\n\t\t\t\tcurr += ch;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\tif(curr.length)\r\n\t\tarr.push(curr);\r\n\r\n\tCEP_FIELDS.forEach((f,i)=>map[f]=arr[i]);\r\n\treturn map;\r\n}\r\n\r\nfunction splitFields(txt) {\r\n\tvar tokens = [], map = {};\r\n\tvar res = null;\r\n\r\n\tdo {\r\n\t\tres = FRX.exec(txt);\r\n\t\tif(res) {\r\n\t\t\tvar tok = res[0];\r\n\t\t\tvar idx = res.index;\r\n\t\t\tif(tokens.length) {\r\n\t\t\t\ttokens[tokens.length-1] += txt.substring(0,idx);\r\n\t\t\t}\r\n\t\t\ttokens.push(tok);\r\n\t\t\ttxt = txt.substring(idx+tok.length);\r\n\t\t}\r\n\t\telse if(txt.length && tokens.length) {\r\n\t\t\ttokens[tokens.length-1] += txt;\r\n\t\t\ttxt = \"\";\r\n\t\t}\r\n\t}while(res && txt.length);\r\n\r\n\ttokens.map(t=>t.trim()).map(t=>{\r\n\t\tt = t.split(\"=\");\r\n\t\treturn {k:t.shift(), v:t.join(\"=\")}\r\n\t}).forEach(t=>{\r\n\t\tmap[t.k] = t.v;\r\n\t});\r\n\r\n\treturn map;\r\n}\r\n\r\nmodule.exports = {\r\n\tparse(text) {\r\n\t\tvar headers = splitHeaders(text);\r\n\t\tvar fields = splitFields(headers.extension || \"\");\r\n\t\treturn {\r\n\t\t\theaders : headers,\r\n\t\t\tfields : fields\r\n\t\t}\r\n\t}\r\n}\r\n\n},{}],3:[function(require,module,exports){\nconst\r\n\tPri = require(\"./pri.js\"),\r\n\tCEF = require(\"./cef.js\");\r\n\r\nconst RXS = {\r\n\t\"pri\" : /^<\\d+>/,\r\n\t\"prinmr\" : /^\\d+ /,\r\n\t\"prival\" : /<(\\d+)>/,\r\n\t\"month\" : /^[A-Za-z][a-z]{2} /,\r\n\t\"day\" : /^\\d{1,2} /,\r\n\t\"time\" : /^\\d+:\\d+:\\d+ /,\r\n\t\"ts\" : /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\S+ /,\r\n\t\"invalid\" : /[^a-zA-Z0-9\\.\\$\\-_#%\\/\\[\\]\\(\\)]/,\r\n\t\"sdata\" : /\\[(\\S+)( [^\\=]+\\=\\\"[^\\\"]+\\\")+\\]/g,\r\n\t\"cef\" : /^CEF:\\d+/\r\n}\r\n\r\nconst DOPS = {\r\n\tcef : true,\r\n\tfields : true,\r\n\tpid : true\r\n}\r\n\r\nfunction peek(arr) {\r\n\tdo {\r\n\t\tvar item = arr.shift();\r\n\t\tif(item===undefined) return item;\r\n\t\telse item = item.trim();\r\n\t}while(!item);\r\n\r\n\treturn item;\r\n}\r\n\r\nfunction assign(entry,item) {\r\n\tif(!entry.host) entry.host = item.trim();\r\n\telse if(!entry.appName) entry.appName = item.trim();\r\n\telse if(!entry.pid) entry.pid = item.trim();\r\n\telse if(!entry.messageid) entry.messageid = item.trim();\r\n\telse if(!entry.structuredData) {\r\n\t\tentry.structuredData = item.trim();\r\n\t\treturn false;\r\n\t}\r\n\telse return true;\r\n}\r\n\r\nfunction parse(line,opts) {\r\n\topts = opts || DOPS;\r\n\r\n\tvar pri = line.match(RXS.pri);\r\n\tvar entry = {\r\n\t\toriginalMessage : line\r\n\t};\r\n\r\n\t// First priority\r\n\tif(pri) {\r\n\t\tentry.pri = pri[0];\r\n\t\tentry.prival = parseInt(entry.pri.match(RXS.prival)[1]);\r\n\t\tvar prival = Pri.get(entry.prival);\r\n\t\tentry.facilityval = prival.facility;\r\n\t\tentry.levelval = prival.level;\r\n\t\tentry.facility = Pri.FACILITY[prival.facility].id;\r\n\t\tentry.level = Pri.LEVEL[prival.level].id;\r\n\t}\r\n\telse {\r\n\t\tentry.pri = \"\";\r\n\t\tentry.prival = NaN;\r\n\t}\r\n\r\n\t//Split message\r\n\tvar items = line.substring(entry.pri.length).split(\" \");\r\n\r\n\t// Date search\r\n\tvar endparse = false;\r\n\twhile(line.length && !endparse) {\r\n\t\tvar item = peek(items)+\" \";\r\n\r\n\t\t// RFC RFC5424\r\n\t\tif(item.match(RXS.prinmr)) {\r\n\t\t\tentry.version = parseInt(item);\r\n\t\t\tentry.type = \"RFC5424\";\r\n\t\t\titem = peek(items)+\" \";\r\n\t\t\tif(item.match(RXS.ts)) {\r\n\t\t\t\tentry.ts = new Date(Date.parse(item.match(RXS.ts)[0].trim()));\r\n\t\t\t}\r\n\t\t}\r\n\t\t// BSD\r\n\t\telse if(item.match(RXS.month)) {\r\n\t\t\tentry.type = \"BSD\";\r\n\t\t\tvar month = item.trim();\r\n\t\t\tvar day = peek(items);\r\n\t\t\tvar time = peek(items);\r\n\t\t\tvar year = new Date().getYear() + 1900\r\n\t\t\tentry.ts = new Date(Date.parse(year+\" \"+month+\" \"+day+\" \"+time));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tentry.type = \"UNKNOWN\";\r\n\t\t\titems.unshift(item.trim());\r\n\t\t}\r\n\t\tendparse = true;\r\n\t}\r\n\r\n\t// No timestamp\r\n\tif(!entry.ts) entry.ts = new Date();\r\n\r\n\t// Is a standard syslog message\r\n\tif(entry.type) {\r\n\t\tendparse = false;\r\n\r\n\t\tfunction invalidate(item) {\r\n\t\t\titems.unshift(item);\r\n\t\t\tentry.message = items.join(\" \");\r\n\t\t\tendparse = true;\r\n\t\t}\r\n\r\n\t\twhile(line.length && !endparse) {\r\n\t\t\tvar item = peek(items);\r\n\t\t\tif(!item) {\r\n\t\t\t\tendparse = true;\r\n\t\t\t}\r\n\t\t\telse if(item.endsWith(\":\")){\r\n\t\t\t\tlet eitem = item.replace(/:$/,\"\").trim();\r\n\t\t\t\tif(eitem.match(RXS.invalid)) {\r\n\t\t\t\t\tinvalidate(item);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tassign(entry,eitem)\r\n\t\t\t\t\tentry.message = items.join(\" \");\r\n\t\t\t\t\tendparse = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if(!items.length) {\r\n\t\t\t\tinvalidate(item);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// Invalid item (malformed message)\r\n\t\t\t\tif(item.match(RXS.invalid)) {\r\n\t\t\t\t\tinvalidate(item);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tvar r = assign(entry,item.replace(/: $/,\"\").trim())\r\n\t\t\t\t\tif(r===true) {\r\n\t\t\t\t\t\titems.unshift(item);\r\n\t\t\t\t\t\tentry.message = items.join(\" \");\r\n\t\t\t\t\t\tendparse = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(r===false) {\r\n\t\t\t\t\t\tentry.message = items.join(\" \");\r\n\t\t\t\t\t\tendparse = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tentry.message = items.join(\" \");\r\n\t}\r\n\r\n\t// Chained hostnames\r\n\tentry.chain = (entry.host||\"\").split(\"/\");\r\n\tentry.host = entry.chain.pop();\r\n\r\n\t// Structured data\r\n\tif(entry.type==\"RFC5424\") {\r\n\t\tvar sdata = entry.message.match(RXS.sdata) ||Â [];\r\n\t\tvar idx=0;\r\n\t\tentry.structuredData = sdata.map(item=>{\r\n\t\t\tvar map = {}, nokeys = [];\r\n\t\t\tvar lastKey = null;\r\n\t\t\tidx = entry.message.indexOf(item)+item.length+1;\r\n\t\t\titem.replace(/(^\\[)|(\\]$)/g,\"\").split(\" \").forEach((t,i)=>{\r\n\t\t\t\t// Extra space\r\n\t\t\t\tif(!t.trim()) return;\r\n\t\t\t\t// First element (ID of data)\r\n\t\t\t\tif(i==0) {\r\n\t\t\t\t\tmap[\"$id\"] = t;\r\n\t\t\t\t}\r\n\t\t\t\t// Key/Pair values\r\n\t\t\t\telse {\r\n\t\t\t\t\tvar kv = t.split(\"=\");\r\n\t\t\t\t\t// Correct key/value pair\r\n\t\t\t\t\tif(kv[0] && kv[1] && kv[1]!='\"') {\r\n\t\t\t\t\t\tlastKey = kv.shift();\r\n\t\t\t\t\t\tmap[lastKey] = kv.join(\"=\").replace(/\\\"/g,\"\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Last key had values separated by spaces\r\n\t\t\t\t\telse if(kv[0] && kv[1]===undefined){\r\n\t\t\t\t\t\tmap[lastKey] += \" \"+(kv[0]||\"\").replace(/\\\"/g,\"\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(kv[0] && (!kv[1].length || kv[1]=='\"')){\r\n\t\t\t\t\t\tmap[lastKey] += \" \"+(kv[0]||\"\").replace(/\\\"/g,\"\")+\"=\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn map;\r\n\t\t});\r\n\t\tentry.message = entry.message.substring(idx);\r\n\t}\r\n\r\n\t// CEF Event message\r\n\tif(opts.cef!==false && RXS.cef.test(entry.message)) {\r\n\t\tentry.type = \"CEF\";\r\n\t\tlet cef = CEF.parse(entry.message);\r\n\t\tentry.cef = cef.headers;\r\n\t\tentry.fields = cef.fields;\r\n\t}\r\n\t// Default syslog message\r\n\telse if(opts.fields!==false && entry.type!=\"UNKNOWN\"){\r\n\t\t// Message with fields\r\n\t\tvar fields = [];\r\n\t\tentry.message.split(\",\").forEach(kv=>{\r\n\t\t\tvar prop = kv.split(\"=\");\r\n\t\t\tif(prop.length==2)\r\n\t\t\t\tfields[prop[0]] = prop[1];\r\n\t\t});\r\n\t\tentry.fields = fields;\r\n\t}\r\n\r\n\t// header\r\n\tentry.header = line.substring(0,line.length-entry.message.length);\r\n\r\n\t// PID\r\n\tif(opts.pid && entry.appName && entry.appName.endsWith(\"]\")) {\r\n\t\tlet idx = entry.appName.indexOf(\"[\");\r\n\t\tif(idx>=0) {\r\n\t\t\tentry.pid = entry.appName.substring(idx+1,entry.appName.length-1);\r\n\t\t\tentry.appName = entry.appName.substring(0,idx);\r\n\t\t}\r\n\t}\r\n\r\n\treturn entry;\r\n}\r\n\r\nmodule.exports = function(line,opts) {try {return parse(line,opts)}catch(err){return {err:err}}};\r\n\n},{\"./cef.js\":2,\"./pri.js\":4}],4:[function(require,module,exports){\nconst FACILITY = [\r\n\t{id:\"kern\", label:\"kernel messages\"},\r\n\t{id:\"user\", label:\"user-level messages\"},\r\n\t{id:\"mail\", label:\"mail system\"},\r\n\t{id:\"daemon\", label:\"system daemons\"},\r\n\t{id:\"auth\", label:\"security/authorization messages\"},\r\n\t{id:\"syslog\", label:\"messages generated internally by syslogd\"},\r\n\t{id:\"lpr\", label:\"line printer subsystem\"},\r\n\t{id:\"news\", label:\"network news subsystem\"},\r\n\t{id:\"uucp\", label:\"UUCP subsystem\"},\r\n\t{id:\"cron\", label:\"clock daemon\"},\r\n\t{id:\"authpriv\", label:\"security/authorization messages\"},\r\n\t{id:\"ftp\", label:\"FTP daemon\"},\r\n\t{id:\"ntp\", label:\"NTP subsystem\"},\r\n\t{id:\"security\", label:\"log audit\"},\r\n\t{id:\"console\", label:\"log alert\"},\r\n\t{id:\"solaris-cron\", label:\"clock daemon\"},\r\n\t{id:\"local0\", label:\"locally used facility 0\"},\r\n\t{id:\"local1\", label:\"locally used facility 0\"},\r\n\t{id:\"local2\", label:\"locally used facility 0\"},\r\n\t{id:\"local3\", label:\"locally used facility 0\"},\r\n\t{id:\"local4\", label:\"locally used facility 0\"},\r\n\t{id:\"local5\", label:\"locally used facility 0\"},\r\n\t{id:\"local6\", label:\"locally used facility 0\"},\r\n\t{id:\"local7\", label:\"locally used facility 0\"}\r\n];\r\n\r\nconst LEVEL = [\r\n\t{id:\"emerg\", label:\"system is unusable\"},\r\n\t{id:\"alert\", label:\"action must be taken immediately\"},\r\n\t{id:\"crit\", label:\"critical conditions\"},\r\n\t{id:\"error\", label:\"error conditions\"},\r\n\t{id:\"warn\", label:\"warning conditions\"},\r\n\t{id:\"notice\", label:\"normal but significant condition\"},\r\n\t{id:\"info\", label:\"informational messages\"},\r\n\t{id:\"debug\", label:\"debug-level messages\"}\r\n]\r\n\r\nvar FACILITY_MAP = [];\r\nvar LEVEL_MAP = [];\r\n\r\nFACILITY.forEach((f,i)=>FACILITY_MAP[f.id]=i);\r\nLEVEL.forEach((l,i)=>LEVEL_MAP[l.id]=i);\r\n\r\nmodule.exports.LEVEL = LEVEL;\r\nmodule.exports.FACILITY = FACILITY;\r\nmodule.exports.LEVELS = LEVEL_MAP;\r\nmodule.exports.FACILITIES = FACILITY_MAP;\r\nmodule.exports.get = function(val1,val2) {\r\n\tif(typeof(val1)==\"number\" && typeof(val2)==\"undefined\") {\r\n\t\treturn {\r\n\t\t\tlevel : val1 & 0x7,\r\n\t\t\tfacility : val1 >> 3\r\n\t\t}\r\n\t}\r\n\telse if(typeof(val1)==\"number\" && typeof(val2)==\"number\") {\r\n\t\treturn val1*8 + val2;\r\n\t}\r\n\telse if(typeof(val1)==\"string\" && typeof(val2)==\"number\") {\r\n\t\treturn (FACILITY_MAP[val1]||0)*8 + val2;\r\n\t}\r\n\telse if(typeof(val1)==\"number\" && typeof(val2)==\"string\") {\r\n\t\treturn val1*8 + (LEVEL_MAP[val2]||0);\r\n\t}\r\n\telse if(typeof(val1)==\"string\" && typeof(val2)==\"string\") {\r\n\t\treturn (FACILITY_MAP[val1]||0)*8 + (LEVEL_MAP[val2]||0);\r\n\t}\r\n\telse {\r\n\t\treturn {level:0, facility:0}\r\n\t}\r\n}\r\n\n},{}]},{},[1]);\n"]}